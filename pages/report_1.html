<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ultimate Report Automation Mastery Course</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f0f4f8;
            color: #2c3e50;
            line-height: 1.6;
        }
        #up {
            background: linear-gradient(135deg, #673AB7, #2196F3);
            color: white;
            text-align: center;
            padding: 40px 20px;
            position: relative;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }
        #up-title {
            margin: 0;
            font-size: 2.5em;
            font-weight: 700;
        }
        #up-subtitle {
            font-size: 1.2em;
            margin: 10px 0;
        }
        .home-link {
            position: absolute;
            left: 20px;
            top: 20px;
            color: white;
            text-decoration: none;
            font-size: 1.2em;
            font-weight: 600;
            transition: opacity 0.2s;
        }
        .home-link:hover {
            opacity: 0.8;
        }
        nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 800px;
            margin: 20px auto 0;
        }
        .nav-btn {
            background: linear-gradient(135deg, #512DA8, #673AB7);
            color: white;
            border: none;
            padding: 12px 24px;
            cursor: pointer;
            border-radius: 30px;
            font-weight: 600;
            transition: transform 0.2s, box-shadow 0.2s;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .nav-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }
        .nav-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        .progress-bar {
            flex: 1;
            height: 8px;
            background-color: rgba(255,255,255,0.3);
            border-radius: 4px;
            margin: 0 20px;
            position: relative;
        }
        .progress-fill {
            height: 100%;
            background: linear-gradient(135deg, #FFEB3B, #FF9800);
            border-radius: 4px;
            transition: width 0.3s ease;
        }
        .progress-text {
            position: absolute;
            top: -25px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.9em;
            color: white;
        }
        .main-content {
            display: flex;
            max-width: 1200px;
            margin: 40px auto;
            padding: 0 20px;
        }
        .slide-container {
            flex: 3;
            perspective: 1000px;
        }
        .slide {
            display: none;
            padding: 30px;
            background-color: white;
            border-radius: 20px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.05);
            transform-style: preserve-3d;
            transition: transform 0.5s, opacity 0.5s;
            opacity: 0;
        }
        .active {
            display: block;
            opacity: 1;
            transform: rotateY(0deg);
        }
        .slide h2 {
            color: #673AB7;
            font-size: 2em;
            margin-bottom: 20px;
            position: relative;
        }
        .slide h2::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 0;
            width: 50px;
            height: 3px;
            background: linear-gradient(135deg, #673AB7, #2196F3);
        }
        .illustration {
            text-align: center;
            margin: 30px 0;
            animation: fadeIn 1s ease;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .illustration svg {
            max-width: 100%;
            height: auto;
            filter: drop-shadow(0 5px 10px rgba(103,58,183,0.1));
        }
        .quiz {
            margin: 30px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }
        .quiz label {
            display: block;
            margin: 10px 0;
            cursor: pointer;
        }
        .quiz button {
            background: linear-gradient(135deg, #28a745, #34d058);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 30px;
            cursor: pointer;
            font-weight: 600;
            transition: transform 0.2s;
        }
        .quiz button:hover {
            transform: translateY(-2px);
        }
        .feedback {
            font-weight: 600;
            margin-top: 15px;
            padding: 10px;
            border-radius: 10px;
        }
        .correct { background: #d4edda; color: #155724; }
        .incorrect { background: #f8d7da; color: #721c24; }
        .term {
            cursor: help;
            background: linear-gradient(135deg, #ffd700, #ff8c00);
            -webkit-background-clip: text;
            color: transparent;
            font-weight: 600;
        }
        .tooltip {
            display: none;
            position: fixed;
            background: white;
            border: 1px solid #ddd;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            max-width: 300px;
            z-index: 1000;
        }
        .sidebar {
            flex: 1;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 20px;
            margin-left: 30px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.05);
            height: fit-content;
            position: sticky;
            top: 40px;
            max-height: calc(100vh - 140px); /* Adjusted to account for header and footer */
            overflow-y: auto;
        }
        .sidebar h3 {
            color: #673AB7;
            font-size: 1.5em;
            margin-bottom: 20px;
        }
        .sidebar ul {
            list-style: none;
            padding: 0;
        }
        .sidebar li {
            margin-bottom: 20px;
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
        }
        .sidebar strong {
            display: block;
            font-size: 1.1em;
            margin-bottom: 5px;
        }
        .sidebar p {
            margin: 0;
            font-size: 0.95em;
            color: #555;
        }
        footer {
            text-align: center;
            padding: 15px;
            background: linear-gradient(135deg, #673AB7, #2196F3);
            color: white;
            position: fixed;
            width: 100%;
            bottom: 0;
            font-size: 0.9em;
            box-shadow: 0 -2px 5px rgba(0,0,0,0.1);
            z-index: 100; /* Ensure footer is above other content */
        }
        /* Responsive */
        @media (max-width: 1024px) {
            .main-content {
                flex-direction: column;
            }
            .sidebar {
                margin-left: 0;
                margin-top: 30px;
                position: relative;
                top: 0;
                max-height: none; /* Remove max-height on smaller screens */
            }
        }
        @media (max-width: 768px) {
            #up-title { font-size: 2em; }
            .slide { padding: 20px; }
            nav { flex-direction: column; }
            .nav-btn { margin: 10px 0; }
            .progress-bar { margin: 10px 0; width: 100%; }
            .home-link { font-size: 1em; left: 10px; top: 10px; }
        }
    </style>
</head>
<body>
    <div id="up">
        <a href="#home" class="home-link" id="home-link">‚Üê Back to Home</a>
        <h1 id="up-title">Ultimate Report Automation Mastery Course</h1>
        <p id="up-subtitle">Data-Driven Insights ‚Äì Interactive, Fun, and Easy!</p>
        <nav>
            <button class="nav-btn" id="prev">Previous</button>
            <div class="progress-bar">
                <div class="progress-fill" id="progress-fill"></div>
                <span class="progress-text" id="progress-text">Slide 1 / 30</span>
            </div>
            <button class="nav-btn" id="next">Next</button>
        </nav>
    </div>

    <div class="main-content">
        <div class="slide-container">
            <!-- Slide 1: Introduction -->
            <section class="slide active" id="slide-1">
                <h2>Welcome to Report Automation Mastery!</h2>
                <p>Hello, data analyst in the making! üìä This course integrates report automation, data management, and tool integrations into a comprehensive learning experience. It's interactive (quizzes!), enjoyable (illustrations and analogies!), and simple (step-by-step slides).</p>
                <p>We cover 3 modules: Automation Foundations, Data Mastery, and Integration Excellence. Check the sidebar for term explanations!</p>
                <div class="illustration">
                    <svg width="300" height="150" viewBox="0 0 300 150">
                        <rect x="20" y="20" width="260" height="110" fill="#673AB7" rx="15"/>
                        <text x="150" y="85" fill="white" text-anchor="middle" font-size="24" font-weight="bold">Begin Your Data Quest!</text>
                        <circle cx="150" cy="85" r="40" fill="none" stroke="white" stroke-width="2" stroke-dasharray="5,5"/>
                    </svg>
                </div>
                <p>Click 'Next' to start Module 1: Automation Foundations.</p>
            </section>

            <!-- Slide 2: Module 1 Intro -->
            <section class="slide" id="slide-2">
                <h2>Module 1: Report Automation Foundations</h2>
                <p>"Report Automation" means your data compiles itself into insights! üîÑ Define rules once, and reports generate automatically. Imagine: A self-assembling puzzle of numbers.</p>
                <div class="illustration">
                    <svg width="200" height="200">
                        <circle cx="100" cy="100" r="80" fill="#FFEB3B"/>
                        <text x="100" y="105" text-anchor="middle" font-size="24">üìà</text>
                        <text x="100" y="130" text-anchor="middle" font-size="16">Auto Reports</text>
                    </svg>
                </div>
                <p>Advantages? Precision, timeliness, strategic focus!</p>
            </section>

            <!-- Slide 3: Pain of Manual Reporting -->
            <section class="slide" id="slide-3">
                <h2>The Challenges of Manual Reporting</h2>
                <p>Weekly routines disrupt: Gather data from sources, input into sheets, craft visuals, distribute.</p>
                <p>Issues: Time loss, error risks, outdated info.</p>
                <div class="illustration">
                    <svg width="300" height="150" viewBox="0 0 300 150">
                        <rect x="50" y="30" width="200" height="90" fill="#F44336" rx="10"/>
                        <text x="150" y="75" fill="white" text-anchor="middle" font-size="22" font-weight="bold">Manual Hassles!</text>
                    </svg>
                </div>
            </section>

            <!-- Slide 4: Solution Automation -->
            <section class="slide" id="slide-4">
                <h2>The Automation Answer</h2>
                <p>Develop systems for scheduled, accurate report creation and delivery.</p>
                <ul>
                    <li>Punctual delivery</li>
                    <li>Error-free</li>
                    <li>Time liberation</li>
                    <li>Informed choices</li>
                </ul>
            </section>

            <!-- Slide 5: Four Building Blocks -->
            <section class="slide" id="slide-5">
                <h2>The Four Essential Components</h2>
                <ul>
                    <li>Data Origin: Storage of raw info.</li>
                    <li>Report Layout: Structured presentation.</li>
                    <li>Automation Core: Execution mechanism.</li>
                    <li>Output Destination: Delivery point.</li>
                </ul>
                <div class="illustration">
                    <svg width="300" height="150">
                        <rect x="20" y="20" width="60" height="110" fill="#2196F3" rx="10"/>
                        <rect x="90" y="20" width="60" height="110" fill="#4CAF50" rx="10"/>
                        <rect x="160" y="20" width="60" height="110" fill="#FFC107" rx="10"/>
                        <rect x="230" y="20" width="60" height="110" fill="#F44336" rx="10"/>
                    </svg>
                </div>
            </section>

            <!-- Slide 6: Tools -->
            <section class="slide" id="slide-6">
                <h2>Selecting Tools</h2>
                <p>Google Sheets for data/reporting, Apps Script for automation.</p>
                <p>Alternatives: Excel, Airtable, custom scripts.</p>
            </section>

            <!-- Slide 7: Step 1 Data Source -->
            <section class="slide" id="slide-7">
                <h2>Phase 1: Establish Data Origin</h2>
                <p>Build a Google Sheet with tabs for raw data like "Sales Data".</p>
                <div class="illustration">
                    <svg width="300" height="150">
                        <rect x="50" y="30" width="200" height="90" fill="#2196F3" rx="10"/>
                        <text x="150" y="75" fill="white" text-anchor="middle" font-size="22">Data Hub</text>
                    </svg>
                </div>
            </section>

            <!-- Slide 8: Step 2 Report Template -->
            <section class="slide" id="slide-8">
                <h2>Phase 2: Design Report Layout</h2>
                <p>New tab "Weekly Report" with formulas for summaries and charts.</p>
                <div class="illustration">
                    <svg width="300" height="150">
                        <rect x="50" y="30" width="200" height="90" fill="#4CAF50" rx="10"/>
                        <text x="150" y="75" fill="white" text-anchor="middle" font-size="22">Report Design</text>
                    </svg>
                </div>
            </section>

            <!-- Slide 9: Step 3 Automation Engine -->
            <section class="slide" id="slide-9">
                <h2>Phase 3: Activate Automation Core</h2>
                <p>Access Apps Script via Extensions in Sheets.</p>
                <div class="illustration">
                    <svg width="300" height="150">
                        <rect x="50" y="30" width="200" height="90" fill="#FFC107" rx="10"/>
                        <text x="150" y="75" fill="white" text-anchor="middle" font-size="22">Script Power</text>
                    </svg>
                </div>
            </section>

            <!-- Slide 10: Step 4 Write Script -->
            <section class="slide" id="slide-10">
                <h2>Phase 4: Compose Automation Code</h2>
                <p>Insert provided script for report generation and emailing.</p>
                <p>Quiz: What's the automation engine?</p>
                <div class="quiz">
                    <label><input type="radio" name="q1" value="appsscript"> Apps Script</label>
                    <label><input type="radio" name="q1" value="manual"> Manual input</label>
                    <button data-qnum="1" data-correct="appsscript">Submit</button>
                    <div class="feedback" id="feedback-1"></div>
                </div>
            </section>

            <!-- Slide 11: Script Breakdown -->
            <section class="slide" id="slide-11">
                <h2>Code Breakdown</h2>
                <p>Locate sheet, prepare report, convert to PDF, send email.</p>
            </section>

            <!-- Slide 12: Step 5 Set Schedule -->
            <section class="slide" id="slide-12">
                <h2>Phase 5: Define Schedule</h2>
                <p>Add trigger in Apps Script for weekly execution.</p>
            </section>

            <!-- Slide 13: Automation Complete -->
            <section class="slide" id="slide-13">
                <h2>System Operational!</h2>
                <p>Automated weekly reports delivered seamlessly.</p>
            </section>

            <!-- Slide 14: Module 2 Intro -->
            <section class="slide" id="slide-14">
                <h2>Module 2: Data Management Mastery</h2>
                <p>Data Management: Collect, organize, analyze information effectively. Foundation for reliable reports! üóÉÔ∏è</p>
                <p>Why crucial? Clean data, actionable insights, business growth.</p>
                <div class="illustration">
                    <svg width="300" height="150">
                        <rect x="50" y="30" width="200" height="90" fill="#FFC107" rx="10"/>
                        <text x="150" y="75" fill="white" text-anchor="middle" font-size="22">Data Power!</text>
                    </svg>
                </div>
            </section>

            <!-- Slide 15: Pain of Manual Data Entry -->
            <section class="slide" id="slide-15">
                <h2>Challenges of Manual Entry</h2>
                <p>Slow, error-prone, disrupts workflow.</p>
            </section>

            <!-- Slide 16: Goal Hands-Off System -->
            <section class="slide" id="slide-16">
                <h2>Objective: Automated Data Flow</h2>
                <p>Instant transfer from source to destination.</p>
            </section>

            <!-- Slide 17: Connector Tool -->
            <section class="slide" id="slide-17">
                <h2>Utilizing Connector Tools</h2>
                <p>Zapier as universal app linker.</p>
            </section>

            <!-- Slide 18: Step 1 Set Trigger -->
            <section class="slide" id="slide-18">
                <h2>Phase 1: Configure Trigger</h2>
                <p>Stripe new payment in Zapier.</p>
            </section>

            <!-- Slide 19: Step 2 Test Trigger -->
            <section class="slide" id="slide-19">
                <h2>Phase 2: Verify Trigger</h2>
                <p>Pull sample payment data.</p>
            </section>

            <!-- Slide 20: Step 3 Set Action -->
            <section class="slide" id="slide-20">
                <h2>Phase 3: Define Action</h2>
                <p>Add row in Google Sheets.</p>
            </section>

            <!-- Slide 21: Step 4 Map Data -->
            <section class="slide" id="slide-21">
                <h2>Phase 4: Align Data Fields</h2>
                <p>Match Stripe fields to sheet columns.</p>
                <p>Quiz: What's the connector tool?</p>
                <div class="quiz">
                    <label><input type="radio" name="q2" value="zapier"> Zapier</label>
                    <label><input type="radio" name="q2" value="manual"> Manual copy</label>
                    <button data-qnum="2" data-correct="zapier">Submit</button>
                    <div class="feedback" id="feedback-2"></div>
                </div>
            </section>

            <!-- Slide 22: Step 5 Test Publish -->
            <section class="slide" id="slide-22">
                <h2>Phase 5: Test and Launch</h2>
                <p>Confirm and activate Zap.</p>
            </section>

            <!-- Slide 23: Complete Picture -->
            <section class="slide" id="slide-23">
                <h2>Integrated Automation View</h2>
                <p>From sale to report seamlessly.</p>
            </section>

            <!-- Slide 24: Module 3 Intro -->
            <section class="slide" id="slide-24">
                <h2>Module 3: Linking Data Systems</h2>
                <p>Data sources connect to reports? Through integrations! üîó</p>
                <p>Example: Stripe + Zapier + Sheets.</p>
                <div class="illustration">
                    <svg width="300" height="100">
                        <rect x="20" y="20" width="80" height="60" fill="#673AB7" rx="10"/> <text x="60" y="55" fill="white" text-anchor="middle">Data</text>
                        <path d="M100 50 Q150 0 200 50" stroke="#2c3e50" stroke-width="4" fill="none"/>
                        <rect x="220" y="20" width="80" height="60" fill="#2196F3" rx="10"/> <text x="260" y="55" fill="white" text-anchor="middle">Reports</text>
                    </svg>
                </div>
            </section>

            <!-- Slide 25: Integration Basics -->
            <section class="slide" id="slide-25">
                <h2>Integration Essentials</h2>
                <p>Zapier bridges apps via API for data flow.</p>
            </section>

            <!-- Slide 26: Steps 1-2 -->
            <section class="slide" id="slide-26">
                <h2>Setup Steps: 1-2</h2>
                <p>1. Link Stripe in Zapier.</p>
                <p>2. Set Trigger: New Payment.</p>
            </section>

            <!-- Slide 27: Steps 3-5 -->
            <section class="slide" id="slide-27">
                <h2>Setup Steps: 3-5</h2>
                <p>3. Obtain API from Stripe.</p>
                <p>4. Connect in Zapier.</p>
                <p>5. Map to Sheets Row.</p>
                <p>Quiz: What's the bridge tool?</p>
                <div class="quiz">
                    <label><input type="radio" name="q3" value="zapier"> Zapier</label>
                    <label><input type="radio" name="q3" value="manual"> Manual</label>
                    <button data-qnum="3" data-correct="zapier">Submit</button>
                    <div class="feedback" id="feedback-3"></div>
                </div>
            </section>

            <!-- Slide 28: How It Works -->
            <section class="slide" id="slide-28">
                <h2>Operational Flow</h2>
                <ol>
                    <li>Sale occurs.</li>
                    <li>Zapier adds to sheet.</li>
                    <li>Script generates report.</li>
                    <li>Email delivery.</li>
                </ol>
            </section>

            <!-- Slide 29: Universal Concept -->
            <section class="slide" id="slide-29">
                <h2>Applicable Universally</h2>
                <p>Same for other sources like Shopify.</p>
            </section>

            <!-- Slide 30: Course Takeaways -->
            <section class="slide" id="slide-30">
                <h2>Overall Takeaways</h2>
                <p>Mastered report automation, data handling, integrations! Implement, analyze, drive decisions.</p>
                <p>Bonus: Hover over <span class="term" data-tooltip="Data of raw information. Like recipe ingredients.">Data Source</span> for details!</p>
                <div class="illustration">
                    <svg width="300" height="200" viewBox="0 0 300 200">
                        <path d="M150 20 L170 60 L240 60 L180 90 L200 140 L150 110 L100 140 L120 90 L60 60 L130 60 Z" fill="#FFEB3B" transform="scale(1.5) translate(-75, -30)"/>
                        <text x="150" y="120" text-anchor="middle" fill="#2c3e50" font-size="24" font-weight="bold">Champion!</text>
                    </svg>
                </div>
            </section>
        </div>

        <aside class="sidebar">
            <h3>Technical Terms Glossary</h3>
            <ul>
                <li>
                    <strong>Data Source</strong>
                    <p>The original place where your raw information is stored. This could be a spreadsheet, a database, or an e-commerce platform like Shopify or Stripe. Think of it like this: Your data source is the collection of ingredients for a recipe. It's all the raw material (sales numbers, customer names) you need before you can start "cooking" your report.</p>
                </li>
                <li>
                    <strong>Report Template</strong>
                    <p>A pre-designed layout that organizes your raw data into a readable format with summaries, charts, and key takeaways. Think of it like this: The template is your recipe card. It tells you exactly how to arrange the ingredients (the data) to create the final, delicious dish (the report).</p>
                </li>
                <li>
                    <strong>Google Apps Script</strong>
                    <p>A coding language based on JavaScript that is built into Google Workspace apps (like Sheets, Docs, and Gmail) to let you create custom automations. Think of it like this: It's a set of "superpowers" for your Google apps. It's like a secret cheat code that lets you program Google Sheets to do new tricks it can't normally do, like automatically creating a PDF and emailing it.</p>
                </li>
                <li>
                    <strong>No-Code Automation Tool</strong>
                    <p>A platform (like Zapier or Make) that lets you connect different web apps and automate tasks using a visual interface, without writing any code. Think of it like this: These tools are like digital LEGO sets for your apps. You can take a block from one app (like a new sale from Stripe) and connect it to a block from another app (like adding a row in Google Sheets) to build a custom creation.</p>
                </li>
                <li>
                    <strong>Conditional Logic / Paths</strong>
                    <p>A way to create a "fork in the road" in your automation, allowing it to perform different actions based on specific "if/then" rules. Think of it like this: It's a signpost at a fork in the road. The signpost is your condition (e.g., "IF the sale is over $50"). It tells the traffic (your data) whether to go down Path A (the VIP route) or Path B (the standard route).</p>
                </li>
                <li>
                    <strong>Mapping Data</strong>
                    <p>The process of telling your automation exactly which piece of data from your trigger app should go into which field in your action app. Think of it like this: It's like packing for a move. You take an item from a box in your old house (the trigger data, like "Customer Email") and place it in the correctly labeled box for your new house (the action field, also "Customer Email"). You're mapping "Kitchen Stuff" to the "Kitchen" box.</p>
                </li>
                <li>
                    <strong>Tag (in Email Marketing)</strong>
                    <p>A label you apply to a subscriber to organize and segment your list. Unlike lists, a single subscriber can have multiple tags. Think of it like this: A tag is a sticky note you put on a customer's file folder. All customers are in your filing cabinet (your list), but you might put a yellow "VIP" sticky note on some, and a blue "Bought Product A" sticky note on others. This makes it easy to find and talk to specific groups later.</p>
                </li>
            </ul>
        </aside>
    </div>

    <div id="tooltip" class="tooltip"></div>

    <footer>
        <p>Created by Automation Blueprint ¬© 2025</p>
    </footer>

    <script>
        (function() {
            // Scoped variables to prevent global re-declaration
            let currentSlide = 1;
            const totalSlides = 30;
            const prevBtn = document.getElementById('prev');
            const nextBtn = document.getElementById('next');
            const progressFill = document.getElementById('progress-fill');
            const progressText = document.getElementById('progress-text');
            const homeLink = document.getElementById('home-link');
            const tooltip = document.getElementById('tooltip');
            const slides = document.querySelectorAll('.slide');

            function updateProgress() {
                const progress = ((currentSlide - 1) / (totalSlides - 1)) * 100;
                progressFill.style.width = `${progress}%`;
                progressText.textContent = `Slide ${currentSlide} / ${totalSlides}`;
            }

            function showSlide(n) {
                slides.forEach((slide, index) => {
                    slide.classList.remove('active');
                    slide.style.transform = `rotateY(${n > index + 1 ? -90 : 90}deg)`;
                    slide.style.opacity = 0;
                });
                const targetSlide = document.getElementById(`slide-${n}`);
                targetSlide.classList.add('active');
                targetSlide.style.transform = 'rotateY(0deg)';
                targetSlide.style.opacity = 1;
                currentSlide = n;
                prevBtn.disabled = n === 1;
                nextBtn.disabled = n === totalSlides;
                updateProgress();
            }

            // Named handlers for document-level and button events
            const keyHandler = (e) => {
                if (e.key === 'ArrowLeft' && currentSlide > 1) showSlide(currentSlide - 1);
                if (e.key === 'ArrowRight' && currentSlide < totalSlides) showSlide(currentSlide + 1);
            };

            let touchStartX = 0;
            const touchStartHandler = (e) => { touchStartX = e.changedTouches[0].screenX; };
            const touchEndHandler = (e) => {
                const touchEndX = e.changedTouches[0].screenX;
                if (touchStartX - touchEndX > 50 && currentSlide < totalSlides) showSlide(currentSlide + 1);
                if (touchEndX - touchStartX > 50 && currentSlide > 1) showSlide(currentSlide - 1);
            };

            const prevHandler = () => {
                if (currentSlide > 1) showSlide(currentSlide - 1);
            };

            const nextHandler = () => {
                if (currentSlide < totalSlides) showSlide(currentSlide + 1);
            };

            const homeHandler = (e) => {
                e.preventDefault();
                window.location.hash = 'home'; // Navigate to home, not just reset slide
            };

            // Remove existing listeners to prevent duplicates
            document.removeEventListener('keydown', keyHandler);
            document.removeEventListener('touchstart', touchStartHandler);
            document.removeEventListener('touchend', touchEndHandler);
            if (prevBtn) prevBtn.removeEventListener('click', prevHandler);
            if (nextBtn) nextBtn.removeEventListener('click', nextHandler);
            if (homeLink) homeLink.removeEventListener('click', homeHandler);

            // Add the listeners
            document.addEventListener('keydown', keyHandler);
            document.addEventListener('touchstart', touchStartHandler);
            document.addEventListener('touchend', touchEndHandler);
            if (prevBtn) prevBtn.addEventListener('click', prevHandler);
            if (nextBtn) nextBtn.addEventListener('click', nextHandler);
            if (homeLink) homeLink.addEventListener('click', homeHandler);

            // Tooltip for terms
            document.querySelectorAll('.term').forEach(term => {
                term.addEventListener('mouseover', (e) => {
                    tooltip.textContent = term.dataset.tooltip;
                    tooltip.style.display = 'block';
                    tooltip.style.left = `${e.pageX + 15}px`;
                    tooltip.style.top = `${e.pageY + 15}px`;
                });
                term.addEventListener('mouseout', () => {
                    tooltip.style.display = 'none';
                });
            });

            // Quiz submit listeners: Attach event listeners to buttons using data attributes
            document.querySelectorAll('.quiz button').forEach(btn => {
                btn.addEventListener('click', () => {
                    const qNum = btn.dataset.qnum;
                    const correct = btn.dataset.correct;
                    checkQuiz(qNum, correct);
                });
            });

            function checkQuiz(qNum, correct) {
                const selected = document.querySelector(`input[name="q${qNum}"]:checked`);
                const feedback = document.getElementById(`feedback-${qNum}`);
                if (selected) {
                    feedback.classList.remove('correct', 'incorrect');
                    if (selected.value === correct) {
                        feedback.textContent = 'Correct! üéâ';
                        feedback.classList.add('correct');
                        confettiEffect();
                    } else {
                        feedback.textContent = 'Oops! Try again. üòä';
                        feedback.classList.add('incorrect');
                    }
                }
            }

            function confettiEffect() {
                const colors = ['#ff0000', '#00ff00', '#0000ff', '#ffff00', '#ff00ff'];
                for (let i = 0; i < 50; i++) {
                    const confetti = document.createElement('div');
                    confetti.style.position = 'fixed';
                    confetti.style.width = '10px';
                    confetti.style.height = '10px';
                    confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                    confetti.style.left = `${Math.random() * 100}vw`;
                    confetti.style.top = `${Math.random() * 100}vh`;
                    confetti.style.opacity = '0';
                    confetti.style.transition = 'all 1s ease';
                    document.body.appendChild(confetti);
                    setTimeout(() => {
                        confetti.style.opacity = '1';
                        confetti.style.transform = `translateY(100vh) rotate(${Math.random() * 360}deg)`;
                        confetti.style.opacity = '0';
                    }, 10);
                    setTimeout(() => confetti.remove(), 1000);
                }
            }

            updateProgress();
            showSlide(1); // Initialize first slide
        })();
    </script>
</body>
</html>